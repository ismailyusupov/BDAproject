install.packages(c("RCurl", "RJSONIO", "ggplot2","lubridate","plyr","reshape","quantmod"))
library(RCurl)
library(RJSONIO) 
library(ggplot2) 
library(lubridate)
library(reshape)
library(plyr)
library(quantmod) 
googleData <- read.csv("report.csv", skip=4, nrow=588-5)
googleData$Date <- as.Date(substring(googleData$Week, first=1, last=10))
googleData$Date <- format(googleData$Date, "%Y-%m")
googleDataMonthly <- aggregate(cbind(chase, bank.of.america,wells.fargo)~ Date, data=googleData, FUN=mean)
googleDataMonthly$logChase <- as.numeric(Delt(googleDataMonthly$chase, type = c("log")))
googleDataMonthly$logBoA <- as.numeric(Delt(googleDataMonthly$bank.of.america, type = c("log")))
googleDataMonthly$logWF <- as.numeric(Delt(googleDataMonthly$wells.fargo, type = c("log")))
fname <- "http://www.federalreserve.gov/datadownload/Output.aspx?rel=G19&series=eaa77ea35198c07e837dbe6306fc1be6&lastObs=&from=01/01/2004&to=01/31/2015&filetype=csv&label=include&layout=seriescolumn"
consumercredit <- read.table(fname, header=TRUE, sep=",", skip=5)
consumercredit <- rename(consumercredit, c("Time.Period"="Date", "DTCTL_N.M"="ConsumerCredit"))
consumercredit$LogDiffCredit <- as.numeric(Delt(consumercredit$ConsumerCredit, type = c("log")))
finalData <- merge(googleDataMonthly,consumercredit,by="Date")
finalDataTotal <- subset(finalData, select = c(Date,chase,bank.of.america,wells.fargo))
finalDataLog <- subset(finalData, select = c(Date,logChase,logBoA,logWF,LogDiffCredit))
finalDataTotalMelt <- melt(finalDataTotal)
finalDataLogMelt <- melt(finalDataLog)
ggplot(data=finalDataTotalMelt,aes(x=Date, y=value, colour=variable)) +geom_line()
