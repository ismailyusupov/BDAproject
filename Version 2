setwd ("h:/settings/desktop/BDA/Project")
install.packages(c("RCurl", "RJSONIO", "ggplot2","lubridate","plyr","reshape","quantmod","Rcpp","scales","tseries"))
library(RCurl)
library(RJSONIO) 
library(ggplot2) 
library(lubridate)
library(reshape)
library(plyr)
library(quantmod)
library(Rcpp)
library(scales)
library(tseries)
googleData <- read.csv("report.csv", skip=4, nrow=588-5)
googleData$Date <- substring(googleData$Week, first=1, last=7)
googleDataMonthly <- aggregate(cbind(chase, bank.of.america,wells.fargo)~ Date, data=googleData, FUN=mean)
googleDataMonthly$logChase <- as.numeric(Delt(googleDataMonthly$chase, type = c("log")))
googleDataMonthly$logBoA <- as.numeric(Delt(googleDataMonthly$bank.of.america, type = c("log")))
googleDataMonthly$logWF <- as.numeric(Delt(googleDataMonthly$wells.fargo, type = c("log")))
fname <- "http://www.federalreserve.gov/datadownload/Output.aspx?rel=G19&series=eaa77ea35198c07e837dbe6306fc1be6&lastObs=&from=01/01/2004&to=01/31/2015&filetype=csv&label=include&layout=seriescolumn"
consumercredit <- read.table(fname, header=TRUE, sep=",", skip=5)
consumercredit <- rename(consumercredit, c("Time.Period"="Date", "DTCTL_N.M"="ConsumerCredit"))
consumercredit$LogDiffCredit <- as.numeric(Delt(consumercredit$ConsumerCredit, type = c("log")))
finalData <- merge(googleDataMonthly,consumercredit,by="Date")
finalData$Consumer_credit <- (finalData$ConsumerCredit*100/max(finalData$ConsumerCredit))
finalDataTotal <- subset(finalData, select = c(Date,chase,bank.of.america,wells.fargo,Consumer_credit))
finalDataLog <- subset(finalData, select = c(Date,logChase,logBoA,logWF,LogDiffCredit))
shapiro.test(finalData$LogDiffCredit)
cor.test(finalData$logChase,finalData$LogDiffCredit,method="kendall")
cor.test(finalData$logBoA,finalData$LogDiffCredit,method="kendall")
cor.test(finalData$logWF,finalData$LogDiffCredit,method="kendall")
finalDataTotalMelt <- melt(finalDataTotal)
finalDataLogMelt <- melt(finalDataLog,id=c("LogDiffCredit","Date"))
finalDataTotalMelt$Date <- as.Date(paste0(finalDataTotalMelt$Date,"-01"))
finalDataLogMelt$Date <- as.Date(paste0(finalDataLogMelt$Date,"-01"))
finalDataLog$Date <- as.Date(paste0(finalDataLog$Date,"-01"))
ggplot(finalDataTotalMelt, aes(Date, value, group=variable, colour = variable)) + geom_line()
ggplot(finalDataLogMelt, aes(Date, value, group=variable, colour = variable,legend=FALSE)) + geom_line()+ 
  facet_wrap(~ variable, ncol = 1, scales = "free_y") +
  geom_line(data=finalDataLogMelt,aes(x=Date, y=LogDiffCredit),colour="black")+
  scale_colour_manual(values=c("red","blue","green","black"))
adf.test(googleDataMonthly$chase,alternative="stationary")
adf.test(googleDataMonthly$bank.of.america,alternative="stationary")
adf.test(googleDataMonthly$wells.fargo,alternative="stationary")
adf.test(consumercredit$ConsumerCredit,alternative="stationary")
